# 성적 정규화 출력 스키마

본 문서는 `gradebook_cleaner_browser.html`에서 XLSX 업로드 후 생성되는 최종 출력 컬럼과 추출 규칙을 설명합니다.

## 목적
- 업로드한 성적 XLSX로부터 최소 필수 정보만 일관된 스키마로 추출합니다.
- 불필요한 중간 계산(분포, 원점수/평균 등)은 제외합니다.

## 출력 컬럼 (순서 고정)
1) `학년`: 현재 학년 (A3 또는 상단 스캔에서 추출)
2) `반`: 현재 반 (A3 또는 상단 스캔에서 추출)
3) `번호`: 학생 번호 (A열, 헤더 `번호`)
4) `이름`: 학생 이름 (B열, 헤더 `성명`/`이름` → `이름`으로 통일)
5) `과목학년`: 과목이 속한 학년 (C열, 헤더 `학년`)
6) `과목학기`: 과목이 속한 학기 (D열, 헤더 `학기`)
7) `교과`: 교과 영역 (E열, `교과`/`교과명`/`교과군` 중 사용)
8) `과목명`: 과목 이름 (F열, 헤더 `과목`)
9) `학점`: 학점 수 (G열, 헤더 `학점`)

## 추출 규칙 요약
- 헤더 자동 탐지: 시트 상단 20행 이내에서 `번호/성명/학년/학기/과목/교과` 중 2개 이상 포함된 행을 헤더로 사용.
- 전처리:
  - `번호/성명(이름)/학년/학기/반`은 공란일 경우 위 행 값으로 보간(forward-fill).
  - 숫자 컬럼(`번호/학년/반/학기/학점`)은 숫자로 변환. 빈 문자열은 `null` 처리.
  - `성명`이 있으면 `이름`으로 복사하여 통일.
- 학년/반(A3) 추출:
  - 우선순위: `A3` → `A2` → `B3` → `A1` → 상단 8행×A–E 스캔.
  - 다음 표기 지원: `1학년 2반`, `1학년2반`, `1-2`, `1/2`, 전각 숫자(`１학년 ２반`), 한글 숫자 단자리(`일학년 2반`).
  - 텍스트에서 숫자 2개만 있는 경우에도 앞=학년, 뒤=반으로 해석.

## 동작 파일
- `gradebook_cleaner_browser.html`: 브라우저에서 동작하는 단일 HTML. SheetJS(XLSX) CDN 사용.

## 사용 방법
1) HTML을 브라우저로 열고, XLSX 파일을 업로드합니다.
2) 시트를 선택한 뒤 “정리해서 미리보기”를 클릭합니다.
3) “CSV 다운로드” 또는 “XLSX 다운로드”로 결과를 저장합니다.

## 주의 및 한계
- 학년/반 표기는 시트 상단(A3 우선)에서 감지합니다. 상단에 관련 텍스트가 전혀 없으면 `학년/반`이 비어 있을 수 있습니다.
- CDN이 차단된 환경에서는 SheetJS가 로드되지 않을 수 있습니다. 이 경우 인터넷 연결을 사용하거나 로컬 스크립트로 교체해야 합니다.

## 예시 헤더 (CSV)
```
학년,반,번호,이름,과목학년,과목학기,교과,과목명,학점
```

